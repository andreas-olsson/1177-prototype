import{BaseController as t}from"./BaseController.js";import{generateId as i}from"../../../utilities/utils.js";class e extends t{constructor(t){super(t),this.setupControllers=async()=>{await this.host.updateComplete,this.setupIndividual(),this.host.invalid?this.inputField&&(this.setInputInvalid(this.inputField),this.showErrorMessage()):this.hideErrorMessage()},this.handleInputValidity=t=>{if(this.inputField){t.validity.valid?(this.setInputValid(this.inputField),this.hideErrorMessage()):(this.setInputInvalid(this.inputField),this.showErrorMessage())}},this.host.addController(this)}hostConnected(){super.hostConnected(),this.setupControllers()}invalidChanged(){if("novalidation"in this.host&&this.host.novalidation){const{invalid:t}=this.host;t?this.showErrorMessage():t||this.hideErrorMessage()}}setupIndividual(){this.errorMessageId=i(),this.errorMessage&&this.errorMessage.setAttribute("id",this.errorMessageId),"novalidation"in this.host&&!this.host.novalidation&&this.setupValidationListener()}setupValidationListener(){this.inputField&&(this.inputField.addEventListener("invalid",(t=>this.handleInputValidity(t.target))),this.inputField.addEventListener("blur",(t=>this.handleInputValidity(t.target))),"checkbox"===this.inputField.getAttribute("type")&&this.inputField.addEventListener("change",(t=>this.handleInputValidity(t.target))))}hostDisconnected(){this.inputField&&(this.inputField.removeEventListener("invalid",(t=>this.handleInputValidity(t.target))),this.inputField.removeEventListener("blur",(t=>this.handleInputValidity(t.target))),"checkbox"===this.inputField.getAttribute("type")&&this.inputField.removeEventListener("change",(t=>this.handleInputValidity(t.target))))}}export{e as ErrorController};
