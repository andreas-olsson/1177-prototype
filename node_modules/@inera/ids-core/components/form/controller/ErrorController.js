import{BaseController as t}from"./BaseController.js";import{generateId as i}from"../../../utilities/utils.js";class e extends t{constructor(t){super(t),this.setupControllers=async()=>{await this.host.updateComplete,(this.isNotInGroup()||this.isInGroupWithoutSharedErrorMessage())&&this.setupIndividual(),this.host.getAttribute("valid")&&"true"!==this.host.getAttribute("valid")?this.inputField&&(this.setInputInvalid(this.inputField),this.showErrorMessage()):this.hideErrorMessage()},this.handleInputValidity=t=>{if(this.inputField){t.validity.valid?(this.setInputValid(this.inputField),this.hideErrorMessage()):(this.setInputInvalid(this.inputField),this.showErrorMessage())}},this.host.addController(this)}hostConnected(){this.setupControllers()}isNotInGroup(){return!this.getGroup()}isInGroupWithoutSharedErrorMessage(){return this.getGroup()&&!this.getGroupsSharedErrorMessage()}getGroupsSharedErrorMessage(){const t=this.getGroup()?.childNodes;return t?Array.from(t).find((t=>"ids-error-message"===t.nodeName.toLowerCase())):null}getGroup(){return this.host.closest("ids-select-multiple")||this.host.closest("ids-radio-group")||this.host.closest("ids-checkbox-group")}setupIndividual(){this.errorMessageId=i(),this.errorMessage&&this.errorMessage.setAttribute("id",this.errorMessageId),"novalidation"in this.host&&!this.host.novalidation&&this.setupValidationListener()}setupValidationListener(){this.inputField&&(this.inputField.addEventListener("invalid",(t=>this.handleInputValidity(t.target))),this.inputField.addEventListener("blur",(t=>this.handleInputValidity(t.target))),"checkbox"===this.inputField.getAttribute("type")&&this.inputField.addEventListener("change",(t=>this.handleInputValidity(t.target))))}hostDisconnected(){this.inputField&&(this.inputField.removeEventListener("invalid",(t=>this.handleInputValidity(t.target))),this.inputField.removeEventListener("blur",(t=>this.handleInputValidity(t.target))),"checkbox"===this.inputField.getAttribute("type")&&this.inputField.removeEventListener("change",(t=>this.handleInputValidity(t.target))))}}export{e as ErrorController};
